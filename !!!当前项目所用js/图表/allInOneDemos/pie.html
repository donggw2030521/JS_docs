<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<script src="../js/jquery.min.js"></script>
	<script src="../js/echarts-all.js"></script>
	<script src="underscore.js"></script>
	<script src="cmutils.js"></script>

	<title>pie</title>
</head>
<body>
<div style="display: flex;">
	<div id="main" style="height:400px;border:1px solid #ccc;padding:10px;width: 700px"></div>
	<div id="main2" style="height:400px;border:1px solid #ccc;padding:10px;width: 700px"></div>
	<div id="main3" style="height:400px;border:1px solid #ccc;padding:10px;width: 700px"></div>
	<div id="main4" style="height:400px;border:1px solid #ccc;padding:10px;width: 700px"></div>
</div>
</body>
<script type="text/javascript">
	var colors = {'module1': "red", "module2": 'yellow', 'module3': "blue", 'module4': 'orange', 'module5': 'green'};
	var myopt = {
		timeline: false,
		options: {
			title: {
				'text': '饼图测试',//主标题
				'subtext': '数据来自FBI123',//副标题
				x: 'left', show: false
			},
			toolbox: {
				show: false,
				orient: 'vertical',//横竖，默认是横，y默认top
				x: 'right', y: 'center',
				feature: {
					magicType: {
						show: false
					},
					saveAsImage: {show: true}
				}
			},
			legend: {
				orient: "horizontal",//'horizontal' | 'vertical'
				x: 'center',//图标的标题位置，在x轴和y轴
				y: 'top', show: true
			}
		}
	};
	var mc1 = new cmutils.CMCharts("#main", myopt);
	mc1.drawChart({
		type: 'pie',
		url: "data-pie1.json"
	}, function (data, setting) {
		var modules = _.pluck(data, "name");
		var cols = _.filter(colors, function (v, k) {
			return _.contains(modules, k);
		})
//		setting.color = _.values(colors);
		setting.color = cols;
	});

	var mc2 = new cmutils.CMCharts("#main2", myopt);
	mc2.drawChart({
		type: 'pie',
		url: "data-pie2.json"
	}, function (data, setting) {
		var modules = _.pluck(data, "name");
		var cols = _.filter(colors, function (v, k) {
			return _.contains(modules, k);
		});
		setting.color = cols;
	});

	var mc3 = new cmutils.CMCharts("#main3", myopt);
	mc3.drawChart({
		type: 'pie',
		url: "data-pie3.json"
	}, function (data, setting) {
		var modules = _.pluck(data, "name");
		var cols = _.filter(colors, function (v, k) {
			return _.contains(modules, k);
		});
		setting.color = cols;
	});

	var mc4 = new cmutils.CMCharts("#main4", myopt);
	mc4.drawChart({
		type: 'pie',
		url: "data-pie4.json"
	}, function (data, setting) {
		var modules = _.pluck(data, "name");
		var cols = _.filter(colors, function (v, k) {
			return _.contains(modules, k);
		});
		setting.color = cols;
	});

</script>
</html>